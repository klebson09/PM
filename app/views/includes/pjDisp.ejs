<!-- Right side column. Contains the navbar and content of the page -->
<div class="content-wrapper">
  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 id="notificacaoMensagemTitle" class="modal-title"></h4>
        </div>
        <div class="modal-body">
          <div class="box box-success">
          <!-- <p id="notificacaoMensagemBody"></p> -->
            <form id="msform" action="candidatarse_projeto" method="post" >
              <input type="hidden" id="idProjeto" class="form-control" name="idProjeto" value="" />
              <div class="form-group col-md-12">
                <label for="apresentacaoPj">Faça uma breve apresentação da equipe, seus pontos fortes e fracos e algum projeto vivenciado por algum membro da equipe:</label>
                <textarea class="form-control" name="apresentacao" id="apresentacao" maxlength="2000" rows="8" ></textarea>
              </div>
              <div class="form-group col-md-12">
                <label for="duvidasPj">Se tiver alguma dúvida sobre o projeto a hora de esclarecer é essa:</label>
                <textarea class="form-control" name="duvidas" id="duvidas" maxlength="2000" rows="8" ></textarea>
              </div>
        </div>
      </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                <input type="submit" id="btnEnviarProposta"  class="submit action-button btn  btn-success col-md-offset-5" value="Enviar" />

              </div>
            </form>
      </div>

    </div>
  </div>

<!-- Main content -->
<section class="content">
<!-- Info boxes -->
<!-- START ACCORDION -->
<h2 class="page-header">Projetos</h2>

<div class="row">
<%
for(var i=0; i < data.length; i++){
  %>

  <div class="col-md-6">
    <div class="box box-solid">
      <div class="box-header with-border">
        <h3 class="box-title"><%=data[i].nomeProjeto; %></h3>
        <h1>
        </h1>
      </div><!-- /.box-header -->
      <div class="box-body">
        <div class="box-group" id="accordion">
          <!-- we are adding the .panel class so bootstrap.js collapse plugin detects it -->
          <div class="panel box box-primary">
            <div class="box-header with-border">
              <h4 class="box-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                  <% if(data[i].idPlataforma == 1) { %>
                    Sistema Desktop
                    <% } else if(data[i].idPlataforma == 2) { %>
                      Sistema Mobile
                      <% } else if(data[i].idPlataforma == 3){ %>
                        Sistema Web
                        <% } else { %>
                          Sistema Multiplataforma
                       <% } %>
                      </a>
                    </h4>
                  </div>
                  <div id="collapseOne" class="panel-collapse collapse in">
                    <div class="box-body">
                      <%=data[i].descricao; %>
                    </div>
                    <div class="box-footer ">
                      <form action="/candidatarse_projeto" method="post">
                        <input type="hidden" id="id_projeto" name="idProjeto" value="yy">
                        <input type="hidden" id="id_conta_us" name="idContaUsuario" value="xxx">
                        <!-- <input type="button" id="btnCandidatarSe"  class="submit action-button btn  btn-success col-md-offset-5" data-target="#data-target="#myModal"" value="Candidatar-se"  /> -->

                      </form>
                      <!-- <button type="button" id="btnCandidatarSe"  class="submit action-button btn  btn-success col-md-offset-5" data-target="#data-target="#myModal"" value="Candidatar-se"  /> -->

                        <button type="button" class="btn btn-info btn-lg" data-toggle="modal" value="<%=data[i].idProjeto;%>" onclick="btnIdProjeto(this.value)" data-target="#myModal">Candidatar-se</button>
                      <!-- <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal" data-whatever="@mdo">Open modal for @mdo</button> -->
                      <script>
                      const novoValor = <%= data[i].idProjeto; %>;
                      const campo = document.getElementById("id_projeto");
                      campo.value = novoValor;

                      const novoValor2 = <%= data[i].idContaUsuario; %>;
                      const campo2 = document.getElementById("id_conta_us");
                      campo2.value = novoValor2;
                      </script>

                    </div>
                  </div>

                </div>
              </div>
            </div><!-- /.box-body -->
          </div><!-- /.box -->
        </div><!-- /.col -->
        <% } %>
      </div><!-- /.row -->
    </section><!-- /.content -->
  </div><!-- /.content-wrapper -->

  <script>
  var selecionado = null;
  function btnIdProjeto(value) {
    //  alert(value);
      document.getElementById("idProjeto").setAttribute('value',value);
  }

  $('#msform').submit(function(e){

    $.ajax({
        type: 'GET',
        url: 'http://localhost:3000/validar_equipe_tutor',
        dataType: 'json'
      }).done(function(data){
        var resultado = data.resultado;
        console.log("resultado = "+resultado);
        if(resultado == '0'){
          window.alert(data.mensagem);
          return false;
        } else{
            console.log("EQUIPE COM TUTOR - VALIDADA");
        }
        //
      }).fail(function(data){
        window.alert(data.mensagem);
      })

  })

  </script>
